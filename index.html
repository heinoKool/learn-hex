<!doctype html>
<html lang="de">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Hex Lab - Interaktiv</title>
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link
    href="https://fonts.googleapis.com/css2?family=Unbounded:wght@300;500;700&family=Source+Code+Pro:wght@400;600&family=Inter:wght@400;600;700&display=swap"
    rel="stylesheet" />
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous" />
  <style>
    :root {
      color-scheme: light;
      /* Core Palette - Light Mode */
      --ink: #1e293b;
      /* Slate 800 - Main Text */
      --ink-light: #475569;
      /* Slate 600 - Muted Text */

      --surface: #ffffff;
      /* Card Bg */
      --surface-highlight: #f1f5f9;
      /* Slate 100 - Secondary Bg */
      --surface-border: #e2e8f0;
      /* Slate 200 */

      /* Accents - "Blue/Colorful" */
      --accent: #2563eb;
      /* Royal Blue */
      --accent-light: #eff6ff;
      /* Blue 50 */
      --accent-hover: #1d4ed8;

      --success: #10b981;
      /* Emerald */
      --success-bg: #ecfdf5;
      --warning: #f59e0b;
      --danger: #ef4444;

      /* Fonts */
      --font-ui: "Inter", system-ui, sans-serif;
      --font-mono: "Source Code Pro", monospace;

      --shadow-sm: 0 1px 2px 0 rgb(0 0 0 / 0.05);
      --shadow-md: 0 4px 6px -1px rgb(0 0 0 / 0.1);
      --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1);

      --card-radius: 20px;
    }

    body {
      font-family: var(--font-ui);
      background: #f8fafc;
      /* Slate 50 */
      color: var(--ink);
      line-height: 1.6;
    }

    /* Typography */
    h1,
    h2,
    h3,
    h4,
    h5,
    h6 {
      font-family: "Unbounded", system-ui, sans-serif;
      font-weight: 700;
      letter-spacing: -0.02em;
      color: #0f172a;
    }

    .mono {
      font-family: var(--font-mono);
    }

    .text-accent {
      color: var(--accent) !important;
    }

    .bg-accent {
      background-color: var(--accent) !important;
    }

    .text-success {
      color: var(--success) !important;
    }

    /* Cards */
    .level-card {
      background: var(--surface);
      border: 1px solid var(--surface-border);
      border-radius: var(--card-radius);
      padding: 40px;
      margin-bottom: 24px;
      box-shadow: var(--shadow-sm);
      transition: all 0.2s ease;
    }

    .level-card:hover {
      box-shadow: var(--shadow-md);
      transform: translateY(-2px);
    }

    .level-badge {
      display: inline-flex;
      align-items: center;
      padding: 6px 12px;
      background: var(--accent-light);
      color: var(--accent);
      border-radius: 99px;
      font-family: "Unbounded", sans-serif;
      font-size: 0.75rem;
      font-weight: 700;
      letter-spacing: 0.05em;
      text-transform: uppercase;
      margin-bottom: 16px;
    }

    /* Sidebar */
    .sidebar {
      background: var(--surface);
      border-right: 1px solid var(--surface-border);
      padding: 32px 24px;
      height: 100vh;
      position: sticky;
      top: 0;
      overflow-y: auto;
    }

    .sidebar .nav-link {
      color: var(--ink-light);
      border-radius: 8px;
      padding: 10px 16px;
      margin-bottom: 4px;
      font-weight: 500;
    }

    .sidebar .nav-link:hover,
    .sidebar .nav-link.active {
      background: var(--accent-light);
      color: var(--accent);
    }

    .page {
      display: flex;
      min-height: 100vh;
    }

    .content {
      flex: 1;
      min-width: 0;
    }

    @media (max-width: 991.98px) {
      .page {
        flex-direction: column;
      }

      .sidebar {
        position: fixed;
        top: 0;
        left: 0;
        width: 280px;
        height: 100vh;
        z-index: 1050;
        transform: translateX(-100%);
        transition: transform 0.3s ease-in-out;
        box-shadow: var(--shadow-lg);
      }

      .sidebar.show {
        transform: translateX(0);
      }

      .mobile-overlay {
        position: fixed;
        top: 0;
        left: 0;
        width: 100vw;
        height: 100vh;
        background: rgba(0, 0, 0, 0.5);
        z-index: 1040;
        opacity: 0;
        visibility: hidden;
        transition: all 0.3s;
      }

      .mobile-overlay.show {
        opacity: 1;
        visibility: visible;
      }

      .mobile-header {
        display: flex !important;
      }
    }

    /* Mobile Header */
    .mobile-header {
      display: none;
      justify-content: space-between;
      align-items: center;
      padding: 16px 24px;
      background: var(--surface);
      border-bottom: 1px solid var(--surface-border);
      position: sticky;
      top: 0;
      z-index: 1030;
    }

    /* Inputs */
    .form-control,
    .form-select {
      background: var(--surface);
      border: 2px solid var(--surface-border);
      color: var(--ink);
      border-radius: 12px;
      padding: 10px 12px;
      -webkit-appearance: none; /* iOS fix */
    }
    
    .form-control.is-invalid {
      border-color: var(--danger);
      background-color: #fff5f5;
      animation: shake 0.3s;
    }

    @keyframes shake {
      0% { transform: translateX(0); }
      25% { transform: translateX(5px); }
      50% { transform: translateX(-5px); }
      75% { transform: translateX(5px); }
      100% { transform: translateX(0); }
    }

    .form-control:focus,
    .form-select:focus {
      border-color: var(--accent);
      box-shadow: 0 0 0 4px var(--accent-light);
      outline: none;
    }

    /* Bit Visualizer Buttons */
    .bit-btn {
      width: 50px;
      height: 50px;
      border-radius: 50%;
      border: 2px solid var(--surface-border);
      background: var(--surface);
      color: var(--ink-light);
      font-weight: 700;
      font-family: var(--font-mono);
      transition: all 0.1s;
    }

    .bit-btn.active {
      background: var(--accent);
      border-color: var(--accent);
      color: white;
      transform: scale(1.1);
      box-shadow: 0 4px 10px rgba(37, 99, 235, 0.3);
    }

    /* Display Boxes */
    .display-box {
      background: var(--surface-highlight);
      border: 1px solid var(--surface-border);
      border-radius: 16px;
      padding: 24px;
    }

    /* Place Value Chart */
    .pv-chart {
      display: flex;
      gap: 12px;
      overflow-x: auto;
      padding-bottom: 12px;
    }

    .pv-col {
      flex: 1;
      min-width: 80px;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 8px;
      background: var(--surface);
      border: 1px solid var(--surface-border);
      border-radius: 16px;
      padding: 16px;
      box-shadow: var(--shadow-sm);
      text-align: center;
    }

    .pv-header {
      color: var(--ink-light);
      font-weight: 600;
      font-family: var(--font-mono);
    }

    .pv-val {
      color: var(--ink-light);
      font-size: 0.85rem;
    }

    .pv-select {
      border: 2px solid var(--surface-border);
      background: var(--surface-highlight);
      color: var(--accent);
      font-weight: 700;
      font-size: 1.25rem;
      border-radius: 8px;
      padding: 8px;
      width: 100%;
      text-align: center;
      cursor: pointer;
    }

    .pv-result {
      width: 100%;
      text-align: center;
      font-family: var(--font-mono);
      color: var(--success);
      font-weight: 600;
      padding-top: 8px;
      border-top: 1px dashed var(--surface-border);
    }

    .pv-total {
      background: var(--ink);
      /* Keep dark for contrast */
      color: white;
      border-radius: 20px;
      padding: 30px;
      text-align: center;
      margin-top: 30px;
      box-shadow: var(--shadow-lg);
    }

    .pv-total-label {
      font-size: 0.85rem;
      text-transform: uppercase;
      letter-spacing: 0.1em;
      opacity: 0.7;
      margin-bottom: 8px;
      display: block;
    }

    .pv-total-value {
      font-size: 3.5rem;
      font-weight: 700;
      font-family: var(--font-mono);
      line-height: 1;
      color: var(--accent);
      /* Light blue on dark bg */
    }

    /* SPA Navigation */
    .section-hidden {
      display: none !important;
    }

    .nav-link.active {
      background-color: var(--surface-highlight);
      color: var(--accent);
      font-weight: 700;
      border-right: 3px solid var(--accent);
    }

    /* Knowledge Checks */
    [data-kc-options] .btn {
      text-align: left;
      background: var(--surface);
      border-color: var(--surface-border) !important;
      color: var(--ink-light);
    }

    [data-kc-options] .btn:hover {
      border-color: var(--accent) !important;
      color: var(--accent);
      background: var(--accent-light);
    }

    /* Utilities */
    .text-muted {
      color: #64748b !important;
    }

    .bg-surface-highlight {
      background-color: var(--surface-highlight);
    }

    .term {
      text-decoration: underline dotted;
      text-underline-offset: 3px;
      text-decoration-color: var(--accent);
      color: var(--ink);
      cursor: help;
    }

    details.display-box>summary {
      list-style: none;
      cursor: pointer;
      color: var(--accent);
      font-weight: 600;
    }

    details.display-box>summary::-webkit-details-marker {
      display: none;
    }
  </style>
</head>

<body>

  <!-- Mobile Header -->
  <div class="mobile-header">
    <div class="d-flex align-items-center gap-2 text-accent fw-bold">
      <span style="font-size: 1.2rem">⬢</span> HEX LAB
    </div>
    <button class="btn btn-sm btn-outline-secondary" id="mobileNavToggle">
      ☰ Menu
    </button>
  </div>

  <!-- Overlay -->
  <div class="mobile-overlay" id="mobileOverlay"></div>

  <div class="page">
    <aside class="sidebar" id="sidebar">
      <div class="mb-5">
        <div class="d-flex align-items-center gap-2 text-accent fw-bold mb-2">
          <span style="font-size: 1.5rem">⬢</span> HEX LAB
        </div>
        <div class="small text-muted">Verstehen, Umrechnen und Anwenden</div>
      </div>
      <div class="small text-uppercase text-muted fw-bold mb-3 ls-1">
        Kapitel
      </div>
      <nav class="nav flex-column gap-1" id="mainNav">
        <a href="#intro" class="nav-link py-3 px-4 border-bottom border-light-subtle">1. Intro</a>
        <a href="#referenz" class="nav-link py-3 px-4 border-bottom border-light-subtle">2. Hexadezimalsystem</a>
        <a href="#hex-bin" class="nav-link py-3 px-4 border-bottom border-light-subtle">3. Hex ↔ Binär</a>
        <a href="#konvertierung" class="nav-link py-3 px-4 border-bottom border-light-subtle">4. Hex ↔ Dezimal</a>
        <a href="#praxis" class="nav-link py-3 px-4 border-bottom border-light-subtle">5. Praxis</a>
        <a href="#wissenscheck" class="nav-link py-3 px-4">6. Wissenscheck</a>
      </nav>
    </aside>

    <div class="content">
      <!-- LEVEL 1: INTRO -->
      <section id="intro" class="p-4 p-lg-5">
        <div class="level-badge">Kapitel 1</div>
        <h1 class="display-4 fw-bold mb-3">
          Willkommen im <span class="text-accent">Hex Lab</span>
        </h1>
        <p class="lead text-muted mb-5">
          Daten kompakt darstellen. Computer arbeiten rein binär (<span class="mono">11110000...</span>), aber das ist
          für Menschen kaum lesbar. <br />
          <strong>Hex ist die Sprache der IT-Profis</strong>: Egal ob Netzwerk, Speicher oder Farben.
        </p>

        <div class="row g-4">
          <div class="col-lg-6">
            <div class="level-card h-100">
              <h3 class="h5 text-accent mb-3">Deine Mission</h3>
              <p class="text-muted">
                Daten im Rohformat (Binär) sind lang und unübersichtlich.
                Hexadezimal macht aus 8 Bits kompakte 2 Zeichen (z.B.
                <span class="mono">AE</span>).
              </p>
              <p class="text-dark fw-medium">
                Hex fasst immer <span class="text-accent">4 Bits</span> zu
                einem einzigen Zeichen zusammen.
              </p>
              <!-- Visual representation of Bin->Hex -->
              <div
                class="d-flex align-items-center justify-content-center gap-4 mt-4 py-3 bg-surface-highlight rounded-4 border border-secondary border-opacity-10">
                <div class="text-center">
                  <div class="mono text-dark fs-3">1111</div>
                  <div class="small text-muted">Binär</div>
                </div>
                <div class="fs-3 text-accent">→</div>
                <div class="text-center">
                  <div class="mono text-accent fs-3 fw-bold">F</div>
                  <div class="small text-muted">Hex</div>
                </div>
              </div>
            </div>
          </div>
          <div class="col-lg-6">
            <div class="level-card h-100">
              <h3 class="h5 text-accent mb-3">System-Daten</h3>
              <ul class="list-unstyled d-flex flex-column gap-3 text-muted">
                <li class="d-flex align-items-center gap-3">
                  <span class="badge bg-accent text-white rounded-pill">Basis 16</span>
                  <div>Ziffern 0-9 und A-F</div>
                </li>
                <li class="d-flex align-items-center gap-3">
                  <span class="badge bg-surface-highlight border border-secondary text-dark rounded-pill"
                    data-bs-toggle="tooltip" title="Gruppe von 4 Bits (Ein Hex-Zeichen)">Nibble</span>
                  <div>4 <span class="term" data-bs-toggle="tooltip"
                      title="Kleinste Dateneinheit (0 oder 1)">Bits</span> = 1 Hex-Zeichen</div>
                </li>
                <li class="d-flex align-items-center gap-3">
                  <span class="badge bg-surface-highlight border border-secondary text-dark rounded-pill"
                    data-bs-toggle="tooltip" title="Gruppe von 8 Bits (Zwei Hex-Zeichen)">Byte</span>
                  <div>
                    8 <span class="term" data-bs-toggle="tooltip" title="Kleinste Dateneinheit (0 oder 1)">Bits</span> =
                    2 Hex-Zeichen (z.B.
                    <span class="mono text-accent">FF</span>)
                  </div>
                </li>
              </ul>
            </div>
          </div>
        </div>
      </section>

      <!-- LEVEL 2: HEXADECIMAL SYSTEM (Merged Symbols + Machine) -->
      <section id="referenz" class="p-4 p-lg-5">
        <div class="level-badge">Kapitel 2</div>
        <div class="level-card">
          
          <!-- HINT: THE ALPHABET -->
          <h2 class="h3 mb-4">Das Hex-Alphabet</h2>
          <p class="text-muted mb-4">
            Weil wir nach 9 keine einzelnen Ziffern mehr haben, nutzen wir Buchstaben von A bis F für die Werte 10 bis 15.
          </p>

          <div class="d-flex flex-wrap justify-content-center gap-3 mb-5">
            <!-- 0-9 -->
            <div class="d-flex flex-wrap gap-2 justify-content-center">
              <div class="d-flex flex-column align-items-center justify-content-center p-2 bg-white rounded-3 border border-secondary border-opacity-10 shadow-sm" style="width: 56px; height: 68px;">
                <span class="fw-bold fs-4 text-dark lh-1">0</span>
                <span class="text-muted small border-top border-light mt-1 w-100 text-center pt-1" style="font-size:0.65rem">dez:0</span>
              </div>
              <div class="d-flex flex-column align-items-center justify-content-center p-2 bg-white rounded-3 border border-secondary border-opacity-10 shadow-sm" style="width: 56px; height: 68px;">
                <span class="fw-bold fs-4 text-dark lh-1">1</span>
                <span class="text-muted small border-top border-light mt-1 w-100 text-center pt-1" style="font-size:0.65rem">dez:1</span>
              </div>
              <div class="d-flex flex-column align-items-center justify-content-center p-2 bg-white rounded-3 border border-secondary border-opacity-10 shadow-sm" style="width: 56px; height: 68px;">
                <span class="fw-bold fs-4 text-dark lh-1">2</span>
                <span class="text-muted small border-top border-light mt-1 w-100 text-center pt-1" style="font-size:0.65rem">dez:2</span>
              </div>
              <div class="d-flex flex-column align-items-center justify-content-center p-2 bg-white rounded-3 border border-secondary border-opacity-10 shadow-sm" style="width: 56px; height: 68px;">
                <span class="fw-bold fs-4 text-dark lh-1">3</span>
                <span class="text-muted small border-top border-light mt-1 w-100 text-center pt-1" style="font-size:0.65rem">dez:3</span>
              </div>
              <div class="d-flex flex-column align-items-center justify-content-center p-2 bg-white rounded-3 border border-secondary border-opacity-10 shadow-sm" style="width: 56px; height: 68px;">
                <span class="fw-bold fs-4 text-dark lh-1">4</span>
                <span class="text-muted small border-top border-light mt-1 w-100 text-center pt-1" style="font-size:0.65rem">dez:4</span>
              </div>
              <div class="d-flex flex-column align-items-center justify-content-center p-2 bg-white rounded-3 border border-secondary border-opacity-10 shadow-sm" style="width: 56px; height: 68px;">
                <span class="fw-bold fs-4 text-dark lh-1">5</span>
                <span class="text-muted small border-top border-light mt-1 w-100 text-center pt-1" style="font-size:0.65rem">dez:5</span>
              </div>
              <div class="d-flex flex-column align-items-center justify-content-center p-2 bg-white rounded-3 border border-secondary border-opacity-10 shadow-sm" style="width: 56px; height: 68px;">
                <span class="fw-bold fs-4 text-dark lh-1">6</span>
                <span class="text-muted small border-top border-light mt-1 w-100 text-center pt-1" style="font-size:0.65rem">dez:6</span>
              </div>
              <div class="d-flex flex-column align-items-center justify-content-center p-2 bg-white rounded-3 border border-secondary border-opacity-10 shadow-sm" style="width: 56px; height: 68px;">
                <span class="fw-bold fs-4 text-dark lh-1">7</span>
                <span class="text-muted small border-top border-light mt-1 w-100 text-center pt-1" style="font-size:0.65rem">dez:7</span>
              </div>
              <div class="d-flex flex-column align-items-center justify-content-center p-2 bg-white rounded-3 border border-secondary border-opacity-10 shadow-sm" style="width: 56px; height: 68px;">
                <span class="fw-bold fs-4 text-dark lh-1">8</span>
                <span class="text-muted small border-top border-light mt-1 w-100 text-center pt-1" style="font-size:0.65rem">dez:8</span>
              </div>
              <div class="d-flex flex-column align-items-center justify-content-center p-2 bg-white rounded-3 border border-secondary border-opacity-10 shadow-sm" style="width: 56px; height: 68px;">
                <span class="fw-bold fs-4 text-dark lh-1">9</span>
                <span class="text-muted small border-top border-light mt-1 w-100 text-center pt-1" style="font-size:0.65rem">dez:9</span>
              </div>
            </div>

            <!-- A-F -->
            <div class="d-flex flex-wrap gap-2 justify-content-center">
              <div class="d-flex flex-column align-items-center justify-content-center p-2 bg-surface-highlight rounded-3 border border-accent border-opacity-50 shadow-sm" style="width: 56px; height: 68px;">
                <span class="fw-bold fs-4 text-accent lh-1">A</span>
                <span class="text-accent small opacity-75 border-top border-accent border-opacity-25 mt-1 w-100 text-center pt-1" style="font-size:0.65rem">dez:10</span>
              </div>
              <div class="d-flex flex-column align-items-center justify-content-center p-2 bg-surface-highlight rounded-3 border border-accent border-opacity-50 shadow-sm" style="width: 56px; height: 68px;">
                <span class="fw-bold fs-4 text-accent lh-1">B</span>
                <span class="text-accent small opacity-75 border-top border-accent border-opacity-25 mt-1 w-100 text-center pt-1" style="font-size:0.65rem">dez:11</span>
              </div>
              <div class="d-flex flex-column align-items-center justify-content-center p-2 bg-surface-highlight rounded-3 border border-accent border-opacity-50 shadow-sm" style="width: 56px; height: 68px;">
                <span class="fw-bold fs-4 text-accent lh-1">C</span>
                <span class="text-accent small opacity-75 border-top border-accent border-opacity-25 mt-1 w-100 text-center pt-1" style="font-size:0.65rem">dez:12</span>
              </div>
              <div class="d-flex flex-column align-items-center justify-content-center p-2 bg-surface-highlight rounded-3 border border-accent border-opacity-50 shadow-sm" style="width: 56px; height: 68px;">
                <span class="fw-bold fs-4 text-accent lh-1">D</span>
                <span class="text-accent small opacity-75 border-top border-accent border-opacity-25 mt-1 w-100 text-center pt-1" style="font-size:0.65rem">dez:13</span>
              </div>
              <div class="d-flex flex-column align-items-center justify-content-center p-2 bg-surface-highlight rounded-3 border border-accent border-opacity-50 shadow-sm" style="width: 56px; height: 68px;">
                <span class="fw-bold fs-4 text-accent lh-1">E</span>
                <span class="text-accent small opacity-75 border-top border-accent border-opacity-25 mt-1 w-100 text-center pt-1" style="font-size:0.65rem">dez:14</span>
              </div>
              <div class="d-flex flex-column align-items-center justify-content-center p-2 bg-surface-highlight rounded-3 border border-accent border-opacity-50 shadow-sm" style="width: 56px; height: 68px;">
                <span class="fw-bold fs-4 text-accent lh-1">F</span>
                <span class="text-accent small opacity-75 border-top border-accent border-opacity-25 mt-1 w-100 text-center pt-1" style="font-size:0.65rem">dez:15</span>
              </div>
            </div>
          </div>
          
          <hr class="border-secondary border-opacity-10 my-5">

          <div class="d-flex align-items-center gap-2 mb-4">
            <!-- Icon replacement (Settings/CPU feel) -->
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
              stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
              class="text-secondary">
              <circle cx="12" cy="12" r="3"></circle>
              <path
                d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 5 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z">
              </path>
            </svg>
            <h2 class="h3 mb-0">Der 8-Bit Konverter</h2>
          </div>

          <p class="text-muted mb-5">
            Computer denken in Bytes (8 Bit). Hexadezimal teilt diese 8 Bit in zwei 4er-Gruppen (Nibbles).
            Klicke auf die Bits oder nutze den Slider um zu sehen, wie aus 8 Bits zwei Hex-Ziffern werden.
          </p>

          <!-- The Converter UI -->
          <div class="bg-surface-highlight rounded-4 p-4 p-md-5 border border-secondary border-opacity-10">

            <div class="row g-5 align-items-center justify-content-center text-center">

              <!-- BINARY SECTION -->
              <div class="col-12 col-md-auto">
                <div class="small text-muted fw-bold text-uppercase mb-3 ls-1">Binär (Basis 2)</div>
                <div class="d-flex justify-content-center gap-3">
                  <!-- High Nibble (Bits 4-7) -->
                  <div class="d-flex gap-1 p-2 rounded-3 bg-white border border-secondary border-opacity-10">
                    <button class="bit-switch btn btn-sm p-0 d-flex align-items-center justify-content-center fw-bold mono"
                      data-bit="7" style="width: 32px; height: 48px; font-size: 1.2rem; color: #6366f1;">0</button>
                    <button class="bit-switch btn btn-sm p-0 d-flex align-items-center justify-content-center fw-bold mono"
                      data-bit="6" style="width: 32px; height: 48px; font-size: 1.2rem; color: #6366f1;">0</button>
                    <button class="bit-switch btn btn-sm p-0 d-flex align-items-center justify-content-center fw-bold mono"
                      data-bit="5" style="width: 32px; height: 48px; font-size: 1.2rem; color: #6366f1;">0</button>
                    <button class="bit-switch btn btn-sm p-0 d-flex align-items-center justify-content-center fw-bold mono"
                      data-bit="4" style="width: 32px; height: 48px; font-size: 1.2rem; color: #6366f1;">0</button>
                  </div>
                  <!-- Low Nibble (Bits 0-3) -->
                  <div class="d-flex gap-1 p-2 rounded-3 bg-white border border-secondary border-opacity-10">
                    <button class="bit-switch btn btn-sm p-0 d-flex align-items-center justify-content-center fw-bold mono"
                      data-bit="3" style="width: 32px; height: 48px; font-size: 1.2rem; color: #ec4899;">0</button>
                    <button class="bit-switch btn btn-sm p-0 d-flex align-items-center justify-content-center fw-bold mono"
                      data-bit="2" style="width: 32px; height: 48px; font-size: 1.2rem; color: #ec4899;">0</button>
                    <button class="bit-switch btn btn-sm p-0 d-flex align-items-center justify-content-center fw-bold mono"
                      data-bit="1" style="width: 32px; height: 48px; font-size: 1.2rem; color: #ec4899;">0</button>
                    <button class="bit-switch btn btn-sm p-0 d-flex align-items-center justify-content-center fw-bold mono"
                      data-bit="0" style="width: 32px; height: 48px; font-size: 1.2rem; color: #ec4899;">0</button>
                  </div>
                </div>
                <div class="d-flex justify-content-between mt-2 px-1 small">
                  <span style="color: #6366f1; font-weight: 600;">High Nibble</span>
                  <span style="color: #ec4899; font-weight: 600;">Low Nibble</span>
                </div>
              </div>

              <!-- ARROW (Hidden on mobile) -->
              <div class="col-md-auto d-none d-md-block">
                <div class="text-muted opacity-50 display-6">→</div>
              </div>

              <!-- HEX SECTION -->
              <div class="col-6 col-md-auto">
                <div class="small text-muted fw-bold text-uppercase mb-3 ls-1">Hex (Basis 16)</div>
                <div
                  class="bg-white rounded-4 p-3 border border-secondary border-opacity-10 shadow-sm d-inline-flex justify-content-center align-items-center gap-1 mono display-4 fw-bold">
                  <span id="convHexHigh" style="color: #6366f1;">0</span>
                  <span id="convHexLow" style="color: #ec4899;">0</span>
                </div>
              </div>

              <!-- DEC SECTION -->
              <div class="col-6 col-md-auto">
                <div class="small text-muted fw-bold text-uppercase mb-3 ls-1">Dezimal</div>
                <div id="convDec"
                  class="bg-white rounded-4 p-3 border border-secondary border-opacity-10 shadow-sm d-inline-block mono display-4 fw-bold text-dark"
                  style="min-width: 120px;">
                  0
                </div>
              </div>

            </div>

            <!-- SLIDER -->
            <div class="mt-5 px-lg-5">
              <label class="d-flex justify-content-between text-muted mono small mb-2">
                <span>0</span>
                <span>Wert anpassen</span>
                <span>255</span>
              </label>
              <input type="range" class="form-range" min="0" max="255" value="0" id="convSlider">
            </div>

          </div>
        </div>
      </section>

      <!-- LEVEL 3: BRIDGE (Renumbered) -->
      <section id="hex-bin" class="p-4 p-lg-5">
        <div class="level-badge">Kapitel 3</div>
        <div class="level-card">
          <h2 class="h3 mb-4">Hex ↔ Binär</h2>
          <p class="text-muted mb-5">
            Die Magie von Hex: Ein Hex-Zeichen entspricht
            <strong>exakt</strong> 4 <span class="term" data-bs-toggle="tooltip"
              title="Kleinste Dateneinheit (0 oder 1)">Bits</span>. Kein mühsames Umrechnen. Profis
            lernen diese 16 Muster (0000 bis 1111) auswendig – wie das kleine
            1x1.
          </p>

          <!-- Bit Visualizer (Light) -->
          <div
            class="nibble-visualizer p-4 bg-surface-highlight rounded-4 border border-secondary border-opacity-10 mb-4">
            <div class="row align-items-center text-center">
              <div class="col-md-7">
                <div class="d-flex justify-content-between align-items-center mb-3">
                    <div class="small text-muted text-uppercase ls-1">Binary Input (1 Nibble)</div>
                    <button id="btnRandNibble" class="btn btn-sm btn-outline-secondary py-0" style="font-size: 0.75rem;">Zufall</button>
                </div>
                <div class="d-flex justify-content-center gap-2">
                  <button class="bit-toggle bit-btn d-flex align-items-center justify-content-center" data-val="8">
                    0
                  </button>
                  <button class="bit-toggle bit-btn d-flex align-items-center justify-content-center" data-val="4">
                    0
                  </button>
                  <button class="bit-toggle bit-btn d-flex align-items-center justify-content-center" data-val="2">
                    0
                  </button>
                  <button class="bit-toggle bit-btn d-flex align-items-center justify-content-center" data-val="1">
                    0
                  </button>
                </div>
                <div class="d-flex justify-content-center gap-2 mt-2 text-muted small mono">
                  <span style="width: 50px">8</span>
                  <span style="width: 50px">4</span>
                  <span style="width: 50px">2</span>
                  <span style="width: 50px">1</span>
                </div>
              </div>
              <div class="col-md-1 d-none d-md-block fs-2 text-muted">→</div>
              <div class="col-md-4">
                <div class="small text-muted text-uppercase mb-3 ls-1">
                  Hex Output
                </div>
                <div class="d-flex flex-column align-items-center">
                  <div id="nibbleHexOut" class="display-3 fw-bold text-accent">
                    0
                  </div>
                  <div id="nibbleDecOut" class="small text-muted mono mt-1">
                    dez: 0
                  </div>
                </div>
              </div>
            </div>
          </div>

          <div class="row g-4">
            <div class="col-lg-6">
              <div class="display-box h-100">
                <div class="d-flex justify-content-between mb-3">
                  <strong class="text-accent">Hex → Binär</strong>
                </div>
                <label class="small text-muted mb-1">Hex Input</label>
                <input id="hexToBinInput" class="form-control mono fs-5 mb-3" type="text" value="2F9" autocapitalize="characters" autocomplete="off" spellcheck="false" />
                <div class="small text-muted mb-1">Binär Output</div>
                <input id="hexToBinOutput" class="form-control mono fs-5 text-accent border-0"
                  style="background: transparent" type="text" readonly />
                <div id="hexToBinSteps" class="mt-3 small text-muted"></div>
              </div>
            </div>
            <div class="col-lg-6">
              <div class="display-box h-100">
                <div class="d-flex justify-content-between mb-3">
                  <strong class="text-accent">Binär → Hex</strong>
                </div>
                <label class="small text-muted mb-1">Binär Input</label>
                <input id="binToHexInput" class="form-control mono fs-5 mb-3" type="text" value="0010 1111 1001" autocomplete="off" spellcheck="false" />
                <div class="small text-muted mb-1">Hex Output</div>
                <input id="binToHexOutput" class="form-control mono fs-5 text-accent border-0"
                  style="background: transparent" type="text" readonly />
                <div id="binToHexSteps" class="mt-3 small text-muted"></div>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- LEVEL 4: CONVERSION (Renumbered) -->
      <section id="konvertierung" class="p-4 p-lg-5">
        <div class="level-badge">Kapitel 4</div>
        <div class="level-card">
          <h2 class="h3 mb-5">Hex ↔ Dezimal</h2>

          <!-- Decoder -->
          <h3 class="h5 text-accent mb-3">Decoder (Hex → Dez)</h3>
          <p class="text-muted mb-4">
            Rechne von Hand nach: <span class="mono">Ziffer · 16^n</span>
          </p>
          <div class="d-flex gap-2 mb-3">
              <button id="btnTrainerHex" class="btn btn-sm btn-outline-primary">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="me-1"><polyline points="23 4 23 10 17 10"></polyline><polyline points="1 20 1 14 7 14"></polyline><path d="M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"></path></svg>
                Zufalls-Aufgabe
              </button>
              <button id="btnTrainerReveal" class="btn btn-sm btn-outline-secondary" disabled>Lösung anzeigen</button>
          </div>
          <div class="row g-3 mb-5">
            <div class="col-md-6">
              <label class="small text-muted">Hex</label>
              <input id="hexToDecInput" class="form-control mono fs-4" type="text" value="1A" autocapitalize="characters" autocomplete="off" spellcheck="false" />
            </div>
            <div class="col-md-6">
              <label class="small text-muted">Dezimal</label>
              <input id="hexToDecOutput" class="form-control mono fs-4 text-accent" type="text" readonly />
            </div>
            <div class="col-12">
              <!-- Collapsible Visualizer -->
              <div class="mb-3">
                  <button class="btn btn-sm btn-outline-secondary d-flex align-items-center gap-2" type="button" data-bs-toggle="collapse" data-bs-target="#hexDecVisualizer" aria-expanded="false" aria-controls="hexDecVisualizer">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><line x1="12" y1="16" x2="12" y2="12"></line><line x1="12" y1="8" x2="12.01" y2="8"></line></svg>
                    Erklärung anzeigen (Visualisierung)
                  </button>
              </div>
              <div class="collapse" id="hexDecVisualizer">
                 <div id="hexToDecSteps" class="mt-4"></div>
              </div>

               <!-- Original Simple Steps container (restored concept) -->
               <div id="hexToDecSimpleSteps" class="mt-2 p-3 bg-surface-highlight rounded text-mono small text-muted"></div>
            </div>
          </div>

          <hr class="border-secondary border-opacity-25 my-5" />

          <!-- Encoder -->
          <h3 class="h5 text-accent mb-3">Encoder (Dez → Hex)</h3>
          <p class="text-muted mb-4">
            Wie wird eine Dezimalzahl zu Hex? Durch Teilen durch 16. Das
            <strong class="text-accent">Ganzzahl-Ergebnis</strong> wandert
            weiter, der <strong class="text-accent">Rest</strong> ist die
            Hex-Ziffer.
          </p>
          <div class="row g-4">
            <div class="col-md-5">
              <div class="display-box h-100">
                <label class="small text-muted mb-2">Dezimal Input</label>
                <input id="decToHexInput" class="form-control mono fs-4 mb-3" type="number" value="47" inputmode="numeric" />
              </div>
            </div>
            <div class="col-md-2 text-center align-self-center fs-3 text-muted">
              →
            </div>
            <div class="col-md-5">
              <div class="display-box h-100 text-center d-flex flex-column justify-content-center">
                <div class="small text-muted mb-1">Hex Ergebnis</div>
                <div id="decToHexResult" class="display-3 fw-bold text-accent mono">
                  2F
                </div>
              </div>
            </div>
          </div>

          <div id="decToHexSteps"
            class="mt-4 p-4 bg-surface-highlight rounded-4 border border-secondary border-opacity-10 text-mono small">
            <div class="text-muted fst-italic">
              Schritte erscheinen hier...
            </div>
          </div>
        </div>
      </section>

      <!-- LEVEL 5: REAL WORLD (Renumbered) -->
      <section id="praxis" class="p-4 p-lg-5 pb-5">
        <div class="level-badge">Kapitel 5</div>
        <div class="level-card">
          <h2 class="h3 mb-4">Praxis: Farben & MAC-Adressen</h2>
          <div class="row g-4">
            <div class="col-lg-6">
              <div class="display-box h-100">
                <div class="d-flex align-items-center gap-2 mb-3">
                  <!-- Palette Icon -->
                  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-muted"><circle cx="13.5" cy="6.5" r=".5"></circle><circle cx="17.5" cy="10.5" r=".5"></circle><circle cx="8.5" cy="7.5" r=".5"></circle><circle cx="6.5" cy="12.5" r=".5"></circle><path d="M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.554C21.965 6.012 17.461 2 12 2z"></path></svg>
                  <h4 class="h6 text-muted text-uppercase mb-0">Praxis: Web-Farben</h4>
                </div>
                
                <p class="small text-muted mb-4">
                  Farben im Web werden fast immer hexadezimal angegeben. 6 Zeichen = 3 Bytes für Rot, Grün und Blau (RGB).
                </p>

                <div class="d-flex flex-column gap-4">
                  <!-- Header: Swatch + Hex Code -->
                  <div class="d-flex align-items-center gap-4">
                    <div id="colorSwatch" class="rounded-4 shadow-sm border border-secondary border-opacity-10" 
                         style="width: 96px; height: 96px; background-color: #3b82f6; transition: background-color 0.2s;">
                    </div>
                    <div>
                      <div class="mono display-5 fw-bold text-dark mb-1" id="hexDisplay">#3B82F6</div>
                      <div class="d-flex gap-3 text-muted mono small">
                        <span>R: <span id="valR_Dec">59</span></span>
                        <span>G: <span id="valG_Dec">130</span></span>
                        <span>B: <span id="valB_Dec">246</span></span>
                      </div>
                    </div>
                  </div>

                  <!-- Sliders -->
                  <div class="d-flex flex-column gap-3">
                    <!-- Red -->
                    <div>
                      <div class="d-flex justify-content-between mono small mb-1">
                        <span class="text-danger fw-bold">Rot</span>
                        <span class="text-danger" id="valR_Hex">3B</span>
                      </div>
                      <input type="range" class="form-range" id="sliderR" min="0" max="255" value="59" style="accent-color: #ef4444;">
                    </div>
                    <!-- Green -->
                    <div>
                      <div class="d-flex justify-content-between mono small mb-1">
                        <span class="text-success fw-bold">Grün</span>
                        <span class="text-success" id="valG_Hex">82</span>
                      </div>
                      <input type="range" class="form-range" id="sliderG" min="0" max="255" value="130" style="accent-color: #22c55e;">
                    </div>
                    <!-- Blue -->
                    <div>
                      <div class="d-flex justify-content-between mono small mb-1">
                        <span class="text-primary fw-bold">Blau</span>
                        <span class="text-primary" id="valB_Hex">F6</span>
                      </div>
                      <input type="range" class="form-range" id="sliderB" min="0" max="255" value="246" style="accent-color: #3b82f6;">
                    </div>
                  </div>
                </div>

                <!-- Hidden inputs for compatibility with existing logic if needed, or we just update them invisibly -->
                <input type="hidden" id="colorInput" value="3B82F6">
                <input type="hidden" id="colorPicker" value="#3B82F6">

                <div class="mt-4 pt-3 border-top border-secondary border-opacity-10">
                  <p class="small text-muted mb-2">
                    <strong>Was ist das?</strong> Bildschirme nutzen <span class="term" data-bs-toggle="tooltip" title="Startet bei Schwarz. Farben entstehen durch Hinzufügen von Licht (anders als bei Tuschkästen).">additive Farbmischung</span> aus <span class="text-danger fw-bold">Rot</span>, <span class="text-success fw-bold">Grün</span> und <span class="text-primary fw-bold">Blau</span> (RGB). Jeder Kanal hat 8 Bit Tiefe, also 256 Abstufungen (0-255).
                  </p>
                  <p class="small text-muted mb-0">
                    <strong>Warum Hex?</strong> Die höchste Stufe 255 ist in Hex zweistellig: <span class="mono fw-bold text-dark">FF</span>. 
                    Ein Code wie <span class="mono bg-surface-highlight px-1 rounded">#22D3EE</span> fasst 3 Bytes (RGB) kompakt zusammen.
                  </p>
                </div>
              </div>

            </div>
            <div class="col-lg-6">
              <div class="display-box h-100">
                <h4 class="h6 text-accent text-uppercase mb-3">
                  MAC-Adressen
                </h4>
                <input id="macInput" class="form-control mono mb-3" type="text" value="A4:5E:60:12:34:AB" />
                <div class="small text-muted">Bytes (Dezimal):</div>
                <div id="macBytes" class="mono text-dark"></div>
                <div class="mt-4 pt-3 border-top border-secondary border-opacity-10">
                  <p class="small text-muted mb-2">
                    <strong>Was ist das?</strong> Eine weltweit eindeutige Hardware-Adresse (<span class="term"
                      data-bs-toggle="tooltip" title="Physikalische Hardware-Adresse einer Netzwerkkarte">MAC</span>)
                    für Netzwerkgeräte. Sie ist
                    48
                    <span class="term" data-bs-toggle="tooltip" title="Kleinste Dateneinheit (0 oder 1)">Bit</span> lang
                    (6 <span class="term" data-bs-toggle="tooltip"
                      title="Gruppe von 8 Bits (Zwei Hex-Zeichen)">Bytes</span>).
                  </p>
                  <p class="small text-muted mb-0">
                    <strong>Warum Hex?</strong> In Binär müssten wir 48 Nullen
                    und Einsen schreiben! Hex verkürzt das auf 12 lesbare
                    Zeichen (z.B. <code>A4:5E...</code>).
                  </p>
                </div>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- LEVEL 6: KNOWLEDGE CHECK -->
      <section id="wissenscheck" class="p-4 p-lg-5 pb-5">
        <div class="level-badge">Kapitel 6</div>
        <div class="level-card">
          <h2 class="h3 mb-4">Wissenscheck</h2>
          <p class="text-muted mb-4">Teste dein Wissen aus allen Kapiteln!</p>

          <div class="d-flex flex-column gap-3">
            <!-- Q1 -->
            <div data-kc-q class="p-3 bg-surface border rounded">
              <div class="fw-semibold text-dark mb-2">
                1. Welche Basis hat das Hexadezimalsystem?
              </div>
              <div class="d-flex gap-2 flex-wrap" data-kc-options>
                <button type="button" class="btn btn-sm btn-light border" data-kc-option
                  data-kc-explain="Falsch. Basis 10 ist unser Dezimalsystem.">
                  10
                </button>
                <button type="button" class="btn btn-sm btn-light border" data-kc-option data-kc-correct="1"
                  data-kc-explain="Richtig! Hexa (6) + Dezi (10) = 16.">
                  16
                </button>
                <button type="button" class="btn btn-sm btn-light border" data-kc-option
                  data-kc-explain="Falsch. Basis 2 ist das Binärsystem.">
                  2
                </button>
              </div>
              <div class="small mt-2" aria-live="polite" data-kc-feedback></div>
            </div>

            <!-- Q2 -->
            <div data-kc-q class="p-3 bg-surface border rounded">
              <div class="fw-semibold text-dark mb-2">
                2. Welches Zeichen steht für den Wert 15?
              </div>
              <div class="d-flex gap-2 flex-wrap" data-kc-options>
                <button type="button" class="btn btn-sm btn-light border" data-kc-option
                  data-kc-explain="Knapp daneben. E ist 14.">
                  E
                </button>
                <button type="button" class="btn btn-sm btn-light border" data-kc-option data-kc-correct="1"
                  data-kc-explain="Richtig! F ist das höchste Symbol (Wert 15).">
                  F
                </button>
                <button type="button" class="btn btn-sm btn-light border" data-kc-option
                  data-kc-explain="Falsch. G gibt es im Hexadezimalsystem nicht.">
                  G
                </button>
              </div>
              <div class="small mt-2" aria-live="polite" data-kc-feedback></div>
            </div>

            <!-- Q3 -->
            <div data-kc-q class="p-3 bg-surface border rounded">
              <div class="fw-semibold text-dark mb-2">
                3. Wie viele Bits sind ein Nibble?
              </div>
              <div class="d-flex gap-2 flex-wrap" data-kc-options>
                <button type="button" class="btn btn-sm btn-light border" data-kc-option data-kc-correct="1"
                  data-kc-explain="Richtig! Ein halbes Byte.">
                  4 Bits
                </button>
                <button type="button" class="btn btn-sm btn-light border" data-kc-option
                  data-kc-explain="Falsch. Das ist ein ganzes Byte.">
                  8 Bits
                </button>
                <button type="button" class="btn btn-sm btn-light border" data-kc-option
                  data-kc-explain="Falsch. Das wäre ein Word (2 Bytes).">
                  16 Bits
                </button>
              </div>
              <div class="small mt-2" aria-live="polite" data-kc-feedback></div>
            </div>

            <!-- Q4 -->
            <div data-kc-q class="p-3 bg-surface border rounded">
              <div class="fw-semibold text-dark mb-2">
                4. Wie viele Hex-Ziffern braucht man für ein Byte (8 Bit)?
              </div>
              <div class="d-flex gap-2 flex-wrap" data-kc-options>
                <button type="button" class="btn btn-sm btn-light border" data-kc-option
                  data-kc-explain="Zu wenig. 1 Hex-Ziffer reicht nur bis 15.">
                  1
                </button>
                <button type="button" class="btn btn-sm btn-light border" data-kc-option data-kc-correct="1"
                  data-kc-explain="Richtig! FF = 255. Genau passend für 8 Bit.">
                  2
                </button>
                <button type="button" class="btn btn-sm btn-light border" data-kc-option
                  data-kc-explain="Zu viel. 4 Ziffern wären 16 Bit (65.535).">
                  4
                </button>
              </div>
              <div class="small mt-2" aria-live="polite" data-kc-feedback></div>
            </div>

            <!-- Q5 -->
            <div data-kc-q class="p-3 bg-surface border rounded">
              <div class="fw-semibold text-dark mb-2">
                5. Welchem Binärwert entspricht Hex "F"?
              </div>
              <div class="d-flex gap-2 flex-wrap" data-kc-options>
                <button type="button" class="btn btn-sm btn-light border" data-kc-option
                  data-kc-explain="Falsch. Das ist A (10).">
                  1010
                </button>
                <button type="button" class="btn btn-sm btn-light border" data-kc-option data-kc-correct="1"
                  data-kc-explain="Richtig! 8+4+2+1 = 15 (F).">
                  1111
                </button>
                <button type="button" class="btn btn-sm btn-light border" data-kc-option
                  data-kc-explain="Falsch. Das ist 9.">
                  1001
                </button>
              </div>
              <div class="small mt-2" aria-live="polite" data-kc-feedback></div>
            </div>

            <!-- Q6 -->
            <div data-kc-q class="p-3 bg-surface border rounded">
              <div class="fw-semibold text-dark mb-2">
                6. Warum nutzen IT-Profis Hex statt Binär?
              </div>
              <div class="d-flex gap-2 flex-wrap" data-kc-options>
                <button type="button" class="btn btn-sm btn-light border" data-kc-option
                  data-kc-explain="Falsch. Computer denken nur in 0 und 1.">
                  Weil Computer Hex besser verstehen
                </button>
                <button type="button" class="btn btn-sm btn-light border" data-kc-option data-kc-correct="1"
                  data-kc-explain="Richtig! Hex ist eine lesbare Abkürzung für uns.">
                  Weil es für Menschen lesbarer und kompakter ist
                </button>
              </div>
              <div class="small mt-2" aria-live="polite" data-kc-feedback></div>
            </div>

            <!-- Q7 -->
            <div data-kc-q class="p-3 bg-surface border rounded">
              <div class="fw-semibold text-dark mb-2">
                7. Welchen Dezimalwert hat "FF" im RGB-Code?
              </div>
              <div class="d-flex gap-2 flex-wrap" data-kc-options>
                <button type="button" class="btn btn-sm btn-light border" data-kc-option data-kc-explain="Zu wenig.">
                  100
                </button>
                <button type="button" class="btn btn-sm btn-light border" data-kc-option
                  data-kc-explain="Falsch. Das wäre ca. 50% Helligkeit.">
                  127
                </button>
                <button type="button" class="btn btn-sm btn-light border" data-kc-option data-kc-correct="1"
                  data-kc-explain="Richtig! Maximum (Full Brightness).">
                  255
                </button>
              </div>
              <div class="small mt-2" aria-live="polite" data-kc-feedback></div>
            </div>
          </div>
        </div>
      </section>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL"
    crossorigin="anonymous"></script>
  <!-- Confetti for Quiz -->
  <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
  <script>
    // Init Tooltips
    const tooltipTriggerList = document.querySelectorAll('[data-bs-toggle="tooltip"]');
    const tooltipList = [...tooltipTriggerList].map(el => new bootstrap.Tooltip(el));

    // Existing Logic maintained and adapted for new classes
    // console.log("Script starting...");
    const hexToDecInput = document.getElementById("hexToDecInput");
    const hexToDecOutput = document.getElementById("hexToDecOutput");
    const hexToDecSteps = document.getElementById("hexToDecSteps");
    const hexToBinInput = document.getElementById("hexToBinInput");
    const hexToBinOutput = document.getElementById("hexToBinOutput");
    const hexToBinSteps = document.getElementById("hexToBinSteps");
    const binToHexInput = document.getElementById("binToHexInput");
    const binToHexOutput = document.getElementById("binToHexOutput");
    const binToHexSteps = document.getElementById("binToHexSteps");
    const hexTable = document.getElementById("hexTable");
    const macInput = document.getElementById("macInput");
    const macBytes = document.getElementById("macBytes");

    // NEW COLOR LOGIC (Slider-based)
    const colorSwatch = document.getElementById("colorSwatch");
    const sliderR = document.getElementById("sliderR");
    const sliderG = document.getElementById("sliderG");
    const sliderB = document.getElementById("sliderB");
    
    // Displays
    const valR_Dec = document.getElementById("valR_Dec");
    const valG_Dec = document.getElementById("valG_Dec");
    const valB_Dec = document.getElementById("valB_Dec");
    const valR_Hex = document.getElementById("valR_Hex");
    const valG_Hex = document.getElementById("valG_Hex");
    const valB_Hex = document.getElementById("valB_Hex");
    const hexDisplay = document.getElementById("hexDisplay");

    const updateColorFromSliders = () => {
       const r = parseInt(sliderR.value);
       const g = parseInt(sliderG.value);
       const b = parseInt(sliderB.value);

       // Update Decimal labels
       if(valR_Dec) valR_Dec.textContent = r;
       if(valG_Dec) valG_Dec.textContent = g;
       if(valB_Dec) valB_Dec.textContent = b;

       // Update Hex labels
       const rHex = r.toString(16).toUpperCase().padStart(2, '0');
       const gHex = g.toString(16).toUpperCase().padStart(2, '0');
       const bHex = b.toString(16).toUpperCase().padStart(2, '0');

       if(valR_Hex) valR_Hex.textContent = rHex;
       if(valG_Hex) valG_Hex.textContent = gHex;
       if(valB_Hex) valB_Hex.textContent = bHex;

       // Combined Hex
       const fullHex = `#${rHex}${gHex}${bHex}`;
       if(hexDisplay) hexDisplay.textContent = fullHex;
       if(colorSwatch) colorSwatch.style.backgroundColor = fullHex;
    };

    if (sliderR && sliderG && sliderB) {
        sliderR.addEventListener("input", updateColorFromSliders);
        sliderG.addEventListener("input", updateColorFromSliders);
        sliderB.addEventListener("input", updateColorFromSliders);
        updateColorFromSliders(); // Init
    }

    const pvChart = document.getElementById("pvChart");

    const pvTotal = document.getElementById("pvTotal");

    const hexSymbols = "0123456789ABCDEF";

    const buildHexTable = () => {
      hexTable.innerHTML = "";
      for (let i = 0; i < 16; i += 1) {
        const cell = document.createElement("div");
        cell.className = "hex-cell";
        const hex = hexSymbols[i];
        cell.innerHTML = `<strong class="mono">${hex}</strong><span class="small text-muted">dez ${i}</span>`;
        hexTable.appendChild(cell);
      }
    };

    const sanitizeHex = (value) =>
      value.toUpperCase().replace(/[^0-9A-F]/g, "");
    const sanitizeBin = (value) => value.replace(/[^01]/g, "");
    const toBin4 = (num) => num.toString(2).padStart(4, "0");
    const groupBinary = (bits) =>
      bits ? bits.match(/.{1,4}/g)?.join(" ") || "" : "";

    const renderHexToBinSteps = (hex) => {
      if (!hex) {
        hexToBinSteps.textContent = "Bitte eine Hexzahl eingeben.";
        return;
      }
      const steps = hex.split("").map((digit) => {
        const value = hexSymbols.indexOf(digit);
        return `${digit} → ${toBin4(value)}`;
      });
      hexToBinSteps.innerHTML = `<div class="d-flex flex-wrap gap-2">${steps.map((s) => `<span class="badge bg-white border border-secondary text-dark">${s}</span>`).join("")}</div>`;
    };

    const renderBinToHexSteps = (bits, padded, padLength) => {
      if (!bits) return;
      const groups = padded.match(/.{1,4}/g) || [];
      const steps = groups.map((g) => {
        const val = parseInt(g, 2);
        return `${g} → ${hexSymbols[val]}`;
      });
      binToHexSteps.innerHTML = `<div class="d-flex flex-wrap gap-2">${steps.map((s) => `<span class="badge bg-white border border-secondary text-dark">${s}</span>`).join("")}</div>`;
    };

    const syncFromHexToBin = () => {
      const raw = hexToBinInput.value;
      const clean = sanitizeHex(raw);
      
      // UX: Feedback for invalid chars
      if (raw.toUpperCase() !== clean && raw !== "") {
          hexToBinInput.classList.add("is-invalid");
          setTimeout(() => hexToBinInput.classList.remove("is-invalid"), 500);
      }
      
      hexToBinInput.value = clean;
      if (!clean) {
        hexToBinOutput.value = "";
        renderHexToBinSteps("");
        return;
      }
      const bits = clean
        .split("")
        .map((d) => toBin4(hexSymbols.indexOf(d)))
        .join("");
      hexToBinOutput.value = groupBinary(bits);
      renderHexToBinSteps(clean);
    };

    const syncFromBinToHex = () => {
      const raw = binToHexInput.value;
      const clean = sanitizeBin(raw);
      
      // UX: Feedback for invalid chars
      if (raw !== clean && raw.replace(/\s/g,'') !== clean) {
          binToHexInput.classList.add("is-invalid");
          setTimeout(() => binToHexInput.classList.remove("is-invalid"), 500);
      }

      if (!clean) {
        binToHexInput.value = "";
        binToHexOutput.value = "";
        renderBinToHexSteps("", "", 0);
        return;
      }
      const padLength = (4 - (clean.length % 4)) % 4;
      const padded = clean.padStart(clean.length + padLength, "0");
      const groups = padded.match(/.{1,4}/g) || [];
      const hex = groups.map((g) => hexSymbols[parseInt(g, 2)]).join("");
      binToHexInput.value = groupBinary(padded);
      binToHexOutput.value = hex;
      renderBinToHexSteps(clean, padded, padLength);
    };

    const hexToDecSimpleSteps = document.getElementById("hexToDecSimpleSteps");
    const renderHexToDecSteps = (hex) => {
      // 0. Clean both containers
      if (!hex) {
          hexToDecSteps.innerHTML = "";
          if(hexToDecSimpleSteps) hexToDecSimpleSteps.innerHTML = "";
          return;
      }
      
      const digits = hex.split("");
      const len = digits.length;
      let stepsHtml = '';
      let calculationParts = [];
      let total = 0;
      let simpleSteps = [];

      // 1. Build Visual Boxes
      stepsHtml += '<div class="d-flex flex-wrap gap-2 justify-content-center mb-4">';
      
      digits.forEach((digit, index) => {
        const position = len - 1 - index; // Power of 16
        const value = parseInt(digit, 16);
        const factor = Math.pow(16, position);
        const subTotal = value * factor;
        
        total += subTotal;
        calculationParts.push(subTotal);

        stepsHtml += `
          <div class="d-flex flex-column align-items-center p-3 bg-white rounded-3 border border-secondary border-opacity-10 shadow-sm" style="min-width: 80px;">
            <div class="small text-muted mb-1 font-monospace">16<sup>${position}</sup></div>
            <div class="display-6 fw-bold text-accent mb-2 font-monospace">${digit}</div>
            <div class="small text-muted border-top border-secondary border-opacity-10 w-100 pt-2 mt-1 text-center">
                ${value} × ${factor}
            </div>
            <div class="fw-bold text-dark mt-1">= ${subTotal}</div>
          </div>
        `;
        
        // Simple line for original view
        simpleSteps.push(`${digit} (${value}) × 16^${position} = ${subTotal}`);
      });
      
      stepsHtml += '</div>';

      // 2. Build Calculation Formula
      stepsHtml += `
        <div class="text-center p-3 bg-surface-secondary rounded-3 border border-secondary border-opacity-10">
          <div class="small text-muted mb-2 text-uppercase ls-1">Berechnung</div>
          <div class="font-monospace fs-5">
            ${calculationParts.join(" + ")} = <strong class="text-accent">${total}</strong>
          </div>
        </div>
      `;

      hexToDecSteps.innerHTML = stepsHtml;
      
      // 3. Render Simple Steps (Original Look)
      if (hexToDecSimpleSteps) {
          hexToDecSimpleSteps.innerHTML = simpleSteps.map(s => `<div>${s}</div>`).join("") + 
          `<div class="border-top border-secondary mt-2 pt-2 text-end text-accent fw-bold">Summe: ${total}</div>`;
      }
    };

    const syncFromHexToDec = () => {
      const raw = hexToDecInput.value;
      const clean = sanitizeHex(raw);
      
      if (raw.toUpperCase() !== clean && raw !== "") {
          hexToDecInput.classList.add("is-invalid");
          setTimeout(() => hexToDecInput.classList.remove("is-invalid"), 500);
      }

      hexToDecInput.value = clean;
      const value = parseInt(clean || "0", 16);
      hexToDecOutput.value = String(value);
      renderHexToDecSteps(clean);
    };

    // MAC logic
    const sanitizeMac = (v) =>
      v
        .toUpperCase()
        .replace(/[^0-9A-F]/g, "")
        .slice(0, 12);
    const formatMac = (v) => (v.match(/.{1,2}/g) || []).join(":");
    const updateMac = () => {
      const raw = macInput.value;
      
      // UX: Feedback only if chars are invalid (ignore colons)
      const rawNoColons = raw.replace(/:/g, "").toUpperCase();
      const clean = sanitizeMac(raw);
      
      if (rawNoColons.length > 0 && rawNoColons !== clean.slice(0, rawNoColons.length)) {
           macInput.classList.add("is-invalid");
           setTimeout(() => macInput.classList.remove("is-invalid"), 500);
      }
      
      macInput.value = formatMac(clean);
      const pairs = clean.match(/.{1,2}/g) || [];
      if (pairs.length > 0) {
        macBytes.textContent = pairs.map((p) => parseInt(p, 16)).join("  ");
      } else {
        macBytes.textContent = "--";
      }
    };

    // ---------------------------------------------------------
    // LEVEL 2: 8-BIT CONVERTER LOGIC
    // ---------------------------------------------------------
    const convSlider = document.getElementById("convSlider");
    const bitSwitches = document.querySelectorAll(".bit-switch");
    const convHexHigh = document.getElementById("convHexHigh");
    const convHexLow = document.getElementById("convHexLow");
    const convDec = document.getElementById("convDec");

    // State
    let converterValue = 0;

    // Helper: Update UI from current value
    const updateConverterUI = () => {
      // 1. Synchronize Slider
      if (convSlider) convSlider.value = converterValue;

      // 2. Synchronize Bits (Binary)
      bitSwitches.forEach((btn) => {
        const bitIndex = parseInt(btn.dataset.bit);
        const isSet = (converterValue >> bitIndex) & 1;
        btn.textContent = isSet;
        
        // Visual toggle style
        if (isSet) {
           btn.style.background = btn.dataset.bit >= 4 ? "rgba(37, 99, 235, 0.9)" : "rgba(236, 72, 153, 0.9)";
           btn.style.color = "#fff";
        } else {
           btn.style.background = "transparent";
           btn.style.color = btn.dataset.bit >= 4 ? "#6366f1" : "#ec4899";
        }
      });

      // 3. Synchronize Hex (Nibbles)
      const highNibble = (converterValue >> 4) & 0xF;
      const lowNibble = converterValue & 0xF;
      
      if (convHexHigh) convHexHigh.textContent = hexSymbols[highNibble];
      if (convHexLow) convHexLow.textContent = hexSymbols[lowNibble];

      // 4. Synchronize Decimal
      if (convDec) convDec.textContent = converterValue;
    };

    // Event Listeners
    if (convSlider) {
      convSlider.addEventListener("input", (e) => {
        converterValue = parseInt(e.target.value);
        updateConverterUI();
      });
    }

    bitSwitches.forEach((btn) => {
      btn.addEventListener("click", () => {
        const bitIndex = parseInt(btn.dataset.bit);
        // Toggle bit using XOR
        converterValue ^= (1 << bitIndex);
        updateConverterUI();
      });
    });


    // Level 3 Visualizer
    const bitToggles = document.querySelectorAll(".bit-toggle");
    const nibbleHexOut = document.getElementById("nibbleHexOut");
    const nibbleDecOut = document.getElementById("nibbleDecOut");

    const updateNibble = () => {
      let val = 0;
      bitToggles.forEach((btn) => {
        if (btn.classList.contains("active")) {
          val += parseInt(btn.dataset.val);
        }
      });
      if (nibbleHexOut) nibbleHexOut.textContent = hexSymbols[val];
      if (nibbleDecOut) nibbleDecOut.textContent = "dez: " + val;
    };

    bitToggles.forEach((btn) => {
      btn.addEventListener("click", () => {
        btn.classList.toggle("active");
        btn.textContent = btn.classList.contains("active") ? "1" : "0";
        updateNibble();
      });
    });

    // Level 6 Encoder (Dez -> Hex)
    const decToHexInput = document.getElementById("decToHexInput");
    const decToHexResult = document.getElementById("decToHexResult");
    const decToHexSteps = document.getElementById("decToHexSteps");

    const updateDecToHex = () => {
      const raw = decToHexInput.value;
      const clean = raw.replace(/[^0-9]/g, "");

      // UX: Feedback for non-numeric input
      if (raw !== clean) {
          decToHexInput.classList.add("is-invalid");
          setTimeout(() => decToHexInput.classList.remove("is-invalid"), 500);
          decToHexInput.value = clean; // Force clean
      }

      const val = parseInt(clean);
      if (isNaN(val)) {
        if(decToHexResult) decToHexResult.textContent = "?";
        if(decToHexSteps) decToHexSteps.innerHTML = '<div class="text-muted fst-italic">Bitte eine Zahl eingeben...</div>';
        return;
      }

      if(decToHexResult) decToHexResult.textContent = val.toString(16).toUpperCase();

      // Division Steps
      let steps = [];
      let curr = val;
      if (curr === 0) steps.push("0");
      while (curr > 0) {
        const remainder = curr % 16;
        const next = Math.floor(curr / 16);
        steps.push(
          `<div>${curr} : 16 = ${next} Rest <strong class="text-accent">${remainder}</strong> (${hexSymbols[remainder]})</div>`,
        );
        curr = next;
      }

      if(decToHexSteps) {
          decToHexSteps.innerHTML = `<div class="d-flex flex-column gap-2">${steps.join("")}</div>
                                       <div class="mt-3 pt-3 border-top border-secondary text-muted">Reste von unten nach oben lesen!</div>`;
      }
    };


    // Init
    if (hexTable) buildHexTable();
    updateConverterUI();
    updateNibble();
    if (hexToBinInput) {
      hexToBinInput.addEventListener("input", syncFromHexToBin);
      syncFromHexToBin();
    }
    if (binToHexInput) {
      binToHexInput.addEventListener("input", syncFromBinToHex);
      syncFromBinToHex();
    }
    if (hexToDecInput) {
      hexToDecInput.addEventListener("input", syncFromHexToDec);
      syncFromHexToDec();
    }
    if (macInput) {
      macInput.addEventListener("input", updateMac);
      updateMac();
    }
    
    // Level 6 Encoder Listener
    if (decToHexInput) {
      decToHexInput.addEventListener("input", updateDecToHex);
      updateDecToHex();
    }

    // Knowledge Check Logic
    document.querySelectorAll("[data-kc-option]").forEach((btn) => {
      btn.addEventListener("click", () => {
        const styles = [
          "border-success",
          "text-success",
          "border-danger",
          "text-danger",
        ];
        const parent = btn.closest("[data-kc-q]");
        parent
          .querySelectorAll("[data-kc-option]")
          .forEach((b) => b.classList.remove(...styles));

        const isCorrect = btn.getAttribute("data-kc-correct") === "1";
        btn.classList.add(isCorrect ? "border-success" : "border-danger");
        btn.classList.add(isCorrect ? "text-success" : "text-danger");

        const feedback = parent.querySelector("[data-kc-feedback]");
        const explanation =
          btn.getAttribute("data-kc-explain") ||
          (isCorrect ? "Richtig!" : "Nicht ganz.");
        
        if (feedback) {
            if (isCorrect) {
                feedback.innerHTML = `<span class="text-success fw-bold">✓ Richtig!</span> ${explanation}`;
                // Simple confetti effect
                if (window.confetti) {
                    confetti({
                        particleCount: 100,
                        spread: 70,
                        origin: { y: 0.6 },
                        disableForReducedMotion: true
                    });
                }
            } else {
                feedback.innerHTML = `<span class="text-danger fw-bold">✗ Leider falsch.</span> ${explanation}`;
            }
        }
      });
    });
    // Navigation Logic (SPA) with Hash Support
    const sections = [
      "intro",
      "referenz",
      "hex-bin",
      "konvertierung",
      "praxis",
      "wissenscheck",
    ];
    const navLinks = document.querySelectorAll("#mainNav .nav-link");

    const showSection = (id) => {
      // Hide all
      sections.forEach((s) => {
        const el = document.getElementById(s);
        if (el) el.classList.add("section-hidden");
      });
      // Show target
      const target = document.getElementById(id);
      if (target) {
          target.classList.remove("section-hidden");
          
          // Accessibility: Focus on the first heading to announce context change
          const heading = target.querySelector("h1, h2, h3");
          if (heading) {
              heading.setAttribute("tabindex", "-1");
              heading.focus({ preventScroll: true }); 
          }
      }

      // Update Nav
      navLinks.forEach((l) => {
        l.classList.remove("active");
        if (l.getAttribute("href") === "#" + id) l.classList.add("active");
      });

      // Scroll to top
      window.scrollTo(0, 0);
    };

    navLinks.forEach((link) => {
      link.addEventListener("click", (e) => {
        // Allow default behavior to update URL hash
        // But we need to intercept to show content manually since we use display:none
        // e.preventDefault(); // REMOVED to allow hash update
        const id = link.getAttribute("href").substring(1);
        showSection(id);
      });
    });

    // Init: Check Hash or Show Intro
    const initHash = window.location.hash.substring(1);
    if (initHash && sections.includes(initHash)) {
        showSection(initHash);
    } else {
        showSection("intro");
    }

    // Handle Back/Forward Browser Buttons
    window.addEventListener("popstate", () => {
        const hash = window.location.hash.substring(1);
        if (hash && sections.includes(hash)) {
            showSection(hash);
        } else {
            showSection("intro");
        }
    });

    // New Feature: Random Nibble (Chapter 3)
    const btnRandNibble = document.getElementById("btnRandNibble");
    if(btnRandNibble) {
        btnRandNibble.addEventListener("click", () => {
            const rand = Math.floor(Math.random() * 16);
            bitToggles.forEach(btn => {
                const val = parseInt(btn.dataset.val);
                // Check if bit is set in rand
                if ((rand & val) === val) {
                    btn.classList.add("active");
                    btn.textContent = "1";
                } else {
                    btn.classList.remove("active");
                    btn.textContent = "0";
                }
            });
            updateNibble();
        });
    }

    // New Feature: Trainer Mode (Chapter 4)
    const btnTrainerHex = document.getElementById("btnTrainerHex");
    const btnTrainerReveal = document.getElementById("btnTrainerReveal");
    
    // Toggle Trainer Visuals
    const setTrainerMode = (isActive) => {
        if (isActive) {
           hexToDecOutput.style.color = "transparent";
           hexToDecSteps.style.opacity = "0"; 
           btnTrainerReveal.disabled = false;
           btnTrainerReveal.textContent = "Lösung anzeigen";
        } else {
           hexToDecOutput.style.color = "var(--bs-primary)"; // Revert to accent color
           hexToDecSteps.style.opacity = "1";
           btnTrainerReveal.disabled = true; 
        }
    };

    if (btnTrainerHex && btnTrainerReveal) {
        btnTrainerHex.addEventListener("click", () => {
            const maxVal = 255; 
            const randVal = Math.floor(Math.random() * maxVal);
            const hexVal = randVal.toString(16).toUpperCase();
            
            hexToDecInput.value = hexVal;
            // Trigger sync
            document.getElementById("hexToDecInput").dispatchEvent(new Event('input'));
            
            setTrainerMode(true); // Hide result
        });

        btnTrainerReveal.addEventListener("click", () => {
             setTrainerMode(false); // Show result
             btnTrainerReveal.textContent = "Gelöst";
        });
        
        // Disable Trainer Mode if user types manually
        hexToDecInput.addEventListener("input", () => {
             if(document.activeElement === hexToDecInput) {
                 setTrainerMode(false);
             }
        });
    }

    // Mobile Navigation Logic
    const toggleBtn = document.getElementById("mobileNavToggle");
    const sidebar = document.getElementById("sidebar");
    const overlay = document.getElementById("mobileOverlay");


    const toggleMenu = () => {
      sidebar.classList.toggle("show");
      overlay.classList.toggle("show");
      const expanded = sidebar.classList.contains("show");
      toggleBtn.setAttribute("aria-expanded", expanded);
    };

    if (toggleBtn) {
      toggleBtn.addEventListener("click", toggleMenu);
      overlay.addEventListener("click", toggleMenu);

      // Close menu when clicking a link on mobile
      document.querySelectorAll(".sidebar .nav-link").forEach(link => {
        link.addEventListener("click", () => {
          if (window.innerWidth < 992 && sidebar.classList.contains("show")) {
             sidebar.classList.remove("show");
             overlay.classList.remove("show");
             toggleBtn.setAttribute("aria-expanded", "false");
          }
        });
      });
    }

  </script>
</body>

</html>